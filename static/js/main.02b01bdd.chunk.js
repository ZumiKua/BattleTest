(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{32:function(e,t,a){e.exports=a(45)},37:function(e,t,a){},38:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n,i,s=a(0),r=a.n(s),o=a(27),l=a.n(o),c=(a(37),a(38),a(3)),u=a(4),d=a(9),h=a(7),p=a(1),m=a(8),v=a(2),g=a(14),b=a(5);!function(e){e[e.Fire=0]="Fire",e[e.Water=1]="Water",e[e.Earth=2]="Earth",e[e.Wind=3]="Wind",e[e.Electric=4]="Electric"}(i||(i={}));var f=(n={},Object(b.a)(n,i.Water,i.Fire),Object(b.a)(n,i.Electric,i.Water),Object(b.a)(n,i.Earth,i.Electric),Object(b.a)(n,i.Wind,i.Earth),Object(b.a)(n,i.Fire,i.Wind),n);function E(e,t){return f[e]===t}function k(e,t){return E(t,e)}var C=a(28);function y(e){var t=e.label,a=Object(C.a)(e,["label"]),n="input";return"checkbox"===a.type&&(n="checkbox"),r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label"},r.a.createElement("label",{className:"label"},t)),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",Object.assign({className:n},a))))))}var S=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).handleDpChange=a.handleDpChange.bind(Object(p.a)(a)),a.handleNameChange=a.handleNameChange.bind(Object(p.a)(a)),a.onAttributeChanged=a.onAttributeChanged.bind(Object(p.a)(a)),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"handleDpChange",value:function(e){this.props.onBattlerChanged(Object(v.a)({},this.props.battler,{dp:Number.parseInt(e.target.value)}))}},{key:"handleNameChange",value:function(e){this.props.onBattlerChanged(Object(v.a)({},this.props.battler,{name:e.target.value}))}},{key:"onAttributeChanged",value:function(e){this.props.onBattlerChanged(Object(v.a)({},this.props.battler,{attribute:Number.parseInt(e.target.value)}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"battler-info-view"},r.a.createElement(y,{label:"DP:",type:"number",onChange:this.handleDpChange,value:this.props.battler.dp}),r.a.createElement(y,{label:"\u540d\u79f0:",type:"text",onChange:this.handleNameChange,value:this.props.battler.name}),r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label is-normal"},r.a.createElement("label",{className:"label"},"\u5c5e\u6027:")),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("div",{className:"select is-fullwidth"},r.a.createElement("select",{onChange:this.onAttributeChanged,value:this.props.battler.attribute},r.a.createElement("option",{value:i.Earth},"\u571f"),r.a.createElement("option",{value:i.Electric},"\u7535"),r.a.createElement("option",{value:i.Fire},"\u706b"),r.a.createElement("option",{value:i.Water},"\u6c34"),r.a.createElement("option",{value:i.Wind},"\u98ce"))))))),r.a.createElement("div",{className:"is-grouped-right is-grouped field"},r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-danger",onClick:this.props.onBattlerDeleted},"\u5220\u9664"))))}}]),t}(r.a.Component),O=function(){function e(t,a,n,i){Object(c.a)(this,e),this.maxDp=void 0,this.dp=void 0,this.initialDp=void 0,this.side=void 0,this.weakState=void 0,this.thisTurnDamaged=void 0,this.attribute=void 0,this.position=void 0,this.name=void 0,this.id=void 0,this.defence=void 0,this.position=n,this.side=t,this.dp=a.dp,this.maxDp=a.dp,this.initialDp=a.dp,this.weakState=!1,this.name=a.name,this.attribute=a.attribute,this.thisTurnDamaged=!1,this.id=i,this.defence=0}return Object(u.a)(e,[{key:"applyAttributeDamage",value:function(e){var t={dpDamage:0,knockedIntoWeak:!1,damageMultipiler:null};if(this.weakState&&(k(e,this.attribute)||(t.damageMultipiler=this.side.onDamageWeakState(E(e,this.attribute)))),E(e,this.attribute))this.dp-=2,t.dpDamage=2;else{if(k(e,this.attribute))return t;this.dp-=1,t.dpDamage=1}return this.dp<=0&&(this.dp=0,this.weakState=!0,t.knockedIntoWeak=!0),t}},{key:"applyRecoverFromWeakState",value:function(){return!!this.weakState&&(this.weakState=!1,this.dp=this.maxDp,!0)}},{key:"applyDpRecovery",value:function(e){if(this.weakState)return 0;var t=this.dp;return this.dp+=e,this.dp>=this.maxDp&&(this.dp=this.maxDp),this.dp<0&&(this.dp=0),this.dp-t}},{key:"applyDefenceIncrease",value:function(e){return this.defence+=e,console.log(this,e),e}},{key:"applyHpDamage",value:function(e,t){var a;return k(t,this.attribute)&&!this.weakState&&(e*=.5),e>0&&this.weakState&&(this.thisTurnDamaged=!0),this.defence<e?(a=this.defence,e-=this.defence,this.defence=0):(this.defence-=e,a=e,e=0),Object(v.a)({},this.side.applyHpDamage(e),{defended:a})}},{key:"onTurnStart",value:function(){this.thisTurnDamaged&&this.weakState&&(this.weakState=!1,this.maxDp-=1,this.dp=this.maxDp),this.thisTurnDamaged=!1,this.defence=0}},{key:"isDead",value:function(){return this.maxDp<=0}},{key:"isWeakState",value:function(){return this.weakState}}]),e}();function N(e){return[Math.floor(e/2),e%2]}function j(e,t){return 2*e+t}function D(e){var t=e.isLeft?[0,1]:[1,0];return r.a.createElement("div",null,r.a.createElement("table",{className:"battler-position-view"},r.a.createElement("tbody",null,[0,1,2].map(function(a){return r.a.createElement("tr",{key:a},0!==a||e.isLeft?null:r.a.createElement("td",{rowSpan:3,className:"frontline"},"\u524d\u7ebf"),t.map(function(t){var n=j(a,t),i=e.battlerPositions[n],s=void 0===i?"unselect":i.toString();return r.a.createElement("td",{key:t,align:"center"},r.a.createElement("div",{className:"select"},r.a.createElement("select",{value:s,onChange:function(t){return function(t,a){var n="unselect"===a.target.value?void 0:parseInt(a.target.value);e.onBattlerPositionChanged(t,n)}(n,t)}},r.a.createElement("option",{value:"unselect"}),e.battlers.map(function(e){return r.a.createElement("option",{key:e.id,value:e.id.toString()},e.name)}))))}),0===a&&e.isLeft?r.a.createElement("td",{rowSpan:3,className:"frontline"},"\u524d\u7ebf"):null)}))))}var A=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).maxBattlerId=void 0,a.handleHpChange=a.handleHpChange.bind(Object(p.a)(a)),a.handleSpChange=a.handleSpChange.bind(Object(p.a)(a)),a.addBattler=a.addBattler.bind(Object(p.a)(a)),a.maxBattlerId=0,a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"handleHpChange",value:function(e){this.props.onSideChanged(Object(v.a)({},this.props.side,{hp:Number.parseInt(e.target.value)}))}},{key:"handleSpChange",value:function(e){this.props.onSideChanged(Object(v.a)({},this.props.side,{sp:Number.parseInt(e.target.value)}))}},{key:"handleBattlerChanged",value:function(e,t){var a=Object(g.a)(this.props.side.battlers),n=a.findIndex(function(t){return t.id===e});a[n]=t,this.props.onSideChanged(Object(v.a)({},this.props.side,{battlers:a}))}},{key:"addBattler",value:function(){var e=Object(g.a)(this.props.side.battlers),t={dp:0,name:"",id:this.maxBattlerId++,attribute:i.Fire};e.push(t),this.props.onSideChanged(Object(v.a)({},this.props.side,{battlers:e}))}},{key:"deleteBattler",value:function(e){var t=this.props.side.battlers.filter(function(t){return t.id!==e}),a=this.props.side.battlerPositions;for(var n in a)a[n]===e&&(a[n]=void 0);this.props.onSideChanged(Object(v.a)({},this.props.side,{battlers:t,battlerPositions:a}))}},{key:"onBattlerPositionChanged",value:function(e,t){var a=Object(v.a)({},this.props.side.battlerPositions,Object(b.a)({},e,t));console.log(a),this.props.onSideChanged(Object(v.a)({},this.props.side,{battlerPositions:a}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"side-info-view"},r.a.createElement(y,{label:"HP:",className:"input",type:"number",onChange:this.handleHpChange,value:this.props.side.hp}),r.a.createElement(y,{label:"AP:",className:"input",type:"number",onChange:this.handleSpChange,value:this.props.side.sp}),r.a.createElement("div",{className:"battlers-view"},r.a.createElement("label",{className:"label"},"\u89d2\u8272\uff1a"),this.props.side.battlers.map(function(t){return r.a.createElement(S,{isLeft:e.props.isLeft,battler:t,onBattlerChanged:e.handleBattlerChanged.bind(e,t.id),onBattlerDeleted:function(){return e.deleteBattler(t.id)},key:t.id})}),r.a.createElement("button",{className:"button",onClick:this.addBattler},"\u6dfb\u52a0\u89d2\u8272")),r.a.createElement(D,{battlers:this.props.side.battlers,battlerPositions:this.props.side.battlerPositions,isLeft:this.props.isLeft,onBattlerPositionChanged:function(t,a){return e.onBattlerPositionChanged(t,a)}})))}}]),t}(r.a.Component),_=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).onAttributeChanged=a.onAttributeChanged.bind(Object(p.a)(a)),a.onAttributeDamageChanged=a.onAttributeDamageChanged.bind(Object(p.a)(a)),a.onHpDamageChanged=a.onHpDamageChanged.bind(Object(p.a)(a)),a.onSpCostChanged=a.onSpCostChanged.bind(Object(p.a)(a)),a.onNameChanged=a.onNameChanged.bind(Object(p.a)(a)),a.onDpRecoveryChanged=a.onDpRecoveryChanged.bind(Object(p.a)(a)),a.onSpRecoveryChanged=a.onSpRecoveryChanged.bind(Object(p.a)(a)),a.onDefenceIncreaseChanged=a.onDefenceIncreaseChanged.bind(Object(p.a)(a)),a.onWeakStateRecoverChanged=a.onWeakStateRecoverChanged.bind(Object(p.a)(a)),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"onAttributeChanged",value:function(e){var t=Object(v.a)({},this.props.action,{attribute:Number.parseInt(e.target.value)});this.props.onActionChanged(t)}},{key:"onHpDamageChanged",value:function(e){var t=Object(v.a)({},this.props.action,{hpDamage:Number.parseInt(e.target.value)});this.props.onActionChanged(t)}},{key:"onSpCostChanged",value:function(e){var t=Object(v.a)({},this.props.action,{spCost:Number.parseInt(e.target.value)});this.props.onActionChanged(t)}},{key:"onAttributeDamageChanged",value:function(e){var t=Object(v.a)({},this.props.action,{attributeDamage:Number.parseInt(e.target.value)});this.props.onActionChanged(t)}},{key:"onNameChanged",value:function(e){var t=Object(v.a)({},this.props.action,{name:e.target.value});this.props.onActionChanged(t)}},{key:"onDpRecoveryChanged",value:function(e){var t=Object(v.a)({},this.props.action,{dpRecovery:Number.parseInt(e.target.value)});this.props.onActionChanged(t)}},{key:"onSpRecoveryChanged",value:function(e){var t=Object(v.a)({},this.props.action,{spRecovery:Number.parseInt(e.target.value)});this.props.onActionChanged(t)}},{key:"onDefenceIncreaseChanged",value:function(e){var t=Object(v.a)({},this.props.action,{defenceIncrease:Number.parseInt(e.target.value)});this.props.onActionChanged(t)}},{key:"onWeakStateRecoverChanged",value:function(e){var t=Object(v.a)({},this.props.action,{weakStateRecover:e.target.checked});this.props.onActionChanged(t)}},{key:"render",value:function(){return r.a.createElement("div",{className:"action-view"},r.a.createElement(y,{label:"\u540d\u79f0",type:"text",value:this.props.action.name,onChange:this.onNameChanged}),r.a.createElement(y,{label:"HP\u4f24\u5bb3",type:"number",value:this.props.action.hpDamage,onChange:this.onHpDamageChanged}),r.a.createElement(y,{label:"AP\u6d88\u8017",type:"number",value:this.props.action.spCost,onChange:this.onSpCostChanged}),r.a.createElement(y,{label:"DP\u56de\u590d",type:"number",value:this.props.action.dpRecovery,onChange:this.onDpRecoveryChanged}),r.a.createElement(y,{label:"AP\u56de\u590d",type:"number",value:this.props.action.spRecovery,onChange:this.onSpRecoveryChanged}),r.a.createElement(y,{label:"\u9632\u5fa1\u503c\u589e\u52a0",type:"number",value:this.props.action.defenceIncrease,onChange:this.onDefenceIncreaseChanged}),r.a.createElement(y,{label:"\u53bb\u9664\u5f31\u70b9\u72b6\u6001",type:"checkbox",value:this.props.action.weakStateRecover,checked:this.props.action.weakStateRecover,onChange:this.onWeakStateRecoverChanged}),r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label is-normal"},r.a.createElement("label",{className:"label"},"\u5c5e\u6027")),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("div",{className:"select is-fullwidth"},r.a.createElement("select",{onChange:this.onAttributeChanged,value:this.props.action.attribute},r.a.createElement("option",{value:i.Earth},"\u571f"),r.a.createElement("option",{value:i.Electric},"\u7535"),r.a.createElement("option",{value:i.Fire},"\u706b"),r.a.createElement("option",{value:i.Water},"\u6c34"),r.a.createElement("option",{value:i.Wind},"\u98ce"))))))),r.a.createElement("div",{className:"is-grouped-right is-grouped field"},r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-danger",onClick:this.props.onActionDeleted},"\u5220\u9664"))))}}]),t}(r.a.Component);function w(e){return r.a.createElement("div",{className:"modal is-active"},r.a.createElement("div",{className:"modal-background"}),r.a.createElement("div",{className:"modal-card"},r.a.createElement("header",{className:"modal-card-head"},r.a.createElement("p",{className:"modal-card-title"},"\u8bfb\u53d6\u5b58\u6863"),r.a.createElement("button",{className:"delete","aria-label":"close",onClick:e.onClosed})),r.a.createElement("section",{className:"modal-card-body"},r.a.createElement("div",{className:"content"},r.a.createElement("ol",null,e.saves.map(function(t,a){return r.a.createElement("li",{className:"load-name",key:a,onClick:function(){return e.onLoad(t)}},r.a.createElement("span",null,t)," ",r.a.createElement("button",{className:"delete",onClick:function(a){e.onDelete(t),a.stopPropagation()}}))}))))))}var P,R,I=a(18),B="_saveMetaItem_V5",x=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).maxActionId=void 0,a.state={side:{hp:0,sp:0,battlers:[],battlerPositions:{}},side2:{hp:0,sp:0,battlers:[],battlerPositions:{}},actions:[],loadShowing:!1,saves:[],currentPage:"sides"},a.maxActionId=0,a.handleSideChanged=a.handleSideChanged.bind(Object(p.a)(a)),a.handleSide2Changed=a.handleSide2Changed.bind(Object(p.a)(a)),a.onAddAction=a.onAddAction.bind(Object(p.a)(a)),a.onComplete=a.onComplete.bind(Object(p.a)(a)),a.migrateSaveV2_TO_V3(),a.migrateSaveV3_TO_V4(),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"handleSideChanged",value:function(e){this.setState({side:e})}},{key:"handleSide2Changed",value:function(e){this.setState({side2:e})}},{key:"onActionChanged",value:function(e,t){this.setState(function(a){var n=Object(g.a)(a.actions),i=n.findIndex(function(t){return t.id===e});return n[i]=Object(v.a)({},n[i],{data:t}),{actions:n}})}},{key:"onAddAction",value:function(){var e=this;this.setState(function(t){var a=Object(g.a)(t.actions);return a.push({id:e.maxActionId++,data:{hpDamage:0,spCost:0,attribute:i.Earth,name:"",spRecovery:0,dpRecovery:0,defenceIncrease:0,weakStateRecover:!1}}),{actions:a}})}},{key:"onRemoveAction",value:function(e){this.setState(function(t){var a=Object(g.a)(t.actions),n=a.findIndex(function(t){return t.id===e});return-1!==n&&a.splice(n,1),{actions:a}})}},{key:"onComplete",value:function(){this.props.onComplete(this.state.side,this.state.side2,this.state.actions.map(function(e){return e.data}))}},{key:"onSave",value:function(){var e=window.prompt("\u5b58\u6863\u540d\u79f0\uff08\u540c\u540d\u4f1a\u81ea\u52a8\u8986\u76d6\uff09",(new Date).toLocaleString());if(null!==e&&""!==(e=e.trim()))if(e!==B&&"_saveMetaItem_V2"!==e){var t,a=JSON.stringify({side:this.state.side,side2:this.state.side2,actions:this.state.actions.map(function(e){return e.data})}),n=localStorage.getItem(B);if(-1!==(t=null===n?[]:JSON.parse(n)).findIndex(function(t){return t===e})){if(!1===window.confirm("\u5b58\u5728\u540c\u540d\u5b58\u6863\uff0c\u662f\u5426\u8986\u76d6\uff1f"))return}else t.push(e);localStorage.setItem(B,JSON.stringify(t)),localStorage.setItem(e,a)}else window.alert("\u975e\u6cd5\u540d\u79f0")}},{key:"migrateSave",value:function(e,t,a){var n=localStorage.getItem(e);if(null!==n){var i=JSON.parse(n),s=[],r=!0,o=!1,l=void 0;try{for(var c,u=i[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var d=c.value,h=localStorage.getItem(d);if(null!==h){var p=JSON.parse(h);p=a(p),s.push(d),localStorage.setItem(d,JSON.stringify(p))}}}catch(E){o=!0,l=E}finally{try{r||null==u.return||u.return()}finally{if(o)throw l}}localStorage.removeItem(e);var m=localStorage.getItem(t),v=[];null!==m&&(v=JSON.parse(m));for(var g=0,b=s;g<b.length;g++){var f=b[g];-1===v.indexOf(f)&&v.push(f)}localStorage.setItem(B,JSON.stringify(v))}}},{key:"migrateSaveV3_TO_V4",value:function(){var e=function(e){var t={},a=!0,n=!1,i=void 0;try{for(var s,r=e.battlers[Symbol.iterator]();!(a=(s=r.next()).done);a=!0){var o=s.value;t[o.position]=o.id,delete o.position}}catch(l){n=!0,i=l}finally{try{a||null==r.return||r.return()}finally{if(n)throw i}}e.battlerPositions=t};this.migrateSave("_saveMetaItem_V3",B,function(t){return e(t.side),e(t.side2),t})}},{key:"migrateSaveV2_TO_V3",value:function(){this.migrateSave("_saveMetaItem_V2","_saveMetaItem_V3",function(e){return e.actions.forEach(function(e){delete e.targetArea}),e})}},{key:"onLoad",value:function(){var e=localStorage.getItem(B);if(null!==e){var t=JSON.parse(e);0!==t.length?this.setState({loadShowing:!0,saves:t}):alert("\u65e0\u5b58\u6863")}else alert("\u65e0\u5b58\u6863")}},{key:"onLoadCanceled",value:function(){this.setState({loadShowing:!1})}},{key:"onDeleteSave",value:function(e){var t=localStorage.getItem(B);if(null===t)return alert("\u8bfb\u53d6\u9519\u8bef\uff01"),void this.setState({loadShowing:!1});var a=JSON.parse(t),n=a.indexOf(e);if(-1===n)return alert("\u8bfb\u53d6\u9519\u8bef\uff01"),void this.setState({loadShowing:!1});a.splice(n,1),localStorage.setItem(B,JSON.stringify(a)),localStorage.removeItem(e),0===a.length?this.setState({loadShowing:!1,saves:a}):this.setState({loadShowing:!0,saves:a})}},{key:"onLoadSelected",value:function(e){var t=this,a=localStorage.getItem(e);if(null===a)return alert("\u8bfb\u53d6\u9519\u8bef\uff01"),void this.setState({loadShowing:!1});var n=JSON.parse(a);this.setState({loadShowing:!1,side:n.side,side2:n.side2,actions:n.actions.map(function(e){return{id:t.maxActionId++,data:e}})})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"tabs"},r.a.createElement("ul",null,r.a.createElement("li",{className:"sides"===this.state.currentPage?"is-active":""},r.a.createElement("a",{onClick:function(t){t.preventDefault(),e.setState({currentPage:"sides"})}},"\u89d2\u8272")),r.a.createElement("li",{className:"actions"===this.state.currentPage?"is-active":""},r.a.createElement("a",{onClick:function(t){t.preventDefault(),e.setState({currentPage:"actions"})}},"\u884c\u4e3a")))),"sides"===this.state.currentPage?r.a.createElement("div",{className:"sides-view"},r.a.createElement("div",{className:"columns edit-view-troop-headers"},r.a.createElement("div",{className:"column edit-view-troop-header red"},r.a.createElement("p",null,"\u7ea2\u65b9")),r.a.createElement("div",{className:"column edit-view-troop-header blue"},r.a.createElement("p",null,"\u84dd\u65b9"))),r.a.createElement("div",{className:"columns side-info-views"},r.a.createElement(A,{side:this.state.side,onSideChanged:this.handleSideChanged,isLeft:!0}),r.a.createElement(A,{side:this.state.side2,onSideChanged:this.handleSide2Changed,isLeft:!1}))):null,"actions"===this.state.currentPage?r.a.createElement("div",{className:"actions-view"},this.state.actions.map(function(t){return r.a.createElement(_,{action:t.data,onActionChanged:e.onActionChanged.bind(e,t.id),key:t.id,onActionDeleted:function(){return e.onRemoveAction(t.id)}})}),r.a.createElement("div",{className:"field"},r.a.createElement("button",{className:"button",onClick:this.onAddAction},"\u6dfb\u52a0"))):null,r.a.createElement("div",{className:"footer-view field is-grouped"},r.a.createElement("p",{className:"control"},r.a.createElement(I.b,{className:"button is-primary",to:"/battle",onClick:this.onComplete},"\u5b8c\u6210")),r.a.createElement("p",{className:"control"},r.a.createElement("button",{className:"button",onClick:function(){return e.onSave()}},"\u4fdd\u5b58")),r.a.createElement("p",{className:"control"},r.a.createElement("button",{className:"button",onClick:function(){return e.onLoad()}},"\u8bfb\u53d6")))),this.state.loadShowing?r.a.createElement(w,{saves:this.state.saves,onClosed:function(){return e.onLoadCanceled()},onLoad:function(t){return e.onLoadSelected(t)},onDelete:function(t){return e.onDeleteSave(t)}}):null)}}]),t}(r.a.Component),M=a(15),T=function(){function e(t){var a=this;Object(c.a)(this,e),this.opponent=void 0,this.damageMultiplier=void 0,this.thisActionDamageMultiplier=void 0,this.damageMultiplierDelta=void 0,this.battlers=void 0,this.hp=void 0,this.sp=void 0,this.battlers=Object.entries(t.battlerPositions).map(function(e,n){var i=Object(M.a)(e,2),s=i[0],r=i[1];return new O(a,t.battlers.find(function(e){return e.id===r}),parseInt(s),n)}),console.log(t.battlerPositions,t.battlers),console.log(this.battlers),this.damageMultiplier=1,this.thisActionDamageMultiplier=1,this.damageMultiplierDelta=.2,this.opponent=null,this.hp=t.hp,this.sp=t.sp}return Object(u.a)(e,[{key:"getBattler",value:function(e){var t=2*e[0]+e[1];return this.battlers.find(function(e){return e.position===t})}},{key:"setOpponent",value:function(e){this.opponent=e}},{key:"applyHpDamage",value:function(e){return this.hp-=e,this.hp<0&&(this.hp=0),{hpDamage:e,isDead:0===this.hp}}},{key:"applySpRecovery",value:function(e){var t=this.sp;return this.sp+=e,this.sp>=10&&(this.sp=10),this.sp<0&&(this.sp=0),this.sp-t}},{key:"onDamageWeakState",value:function(e){var t={multiplierAdded:this.damageMultiplierDelta};return this.thisActionDamageMultiplier+=this.damageMultiplierDelta,this.damageMultiplierDelta+=.2,t}},{key:"onActionEnd",value:function(){this.damageMultiplier=this.thisActionDamageMultiplier}},{key:"onTurnStart",value:function(){this.damageMultiplier=1,this.thisActionDamageMultiplier=1,this.damageMultiplierDelta=.2,this.battlers.forEach(function(e){return e.onTurnStart()}),this.sp<=3&&(this.sp=3)}},{key:"getDisplayDamageMultiplier",value:function(){return this.thisActionDamageMultiplier}}]),e}(),V=function(){function e(t,a,n,i){Object(c.a)(this,e),this.user=void 0,this.targets=void 0,this.data=void 0,this.id=void 0,this.attack=void 0,this.targetPoints=void 0,this.data=t,this.targets=null,this.attack=null,this.user=a,this.targetPoints=n,this.id=i}return Object(u.a)(e,[{key:"canUse",value:function(){return!this.user.isDead()}},{key:"fetchBattlers",value:function(e,t){return t.map(function(t){return e.getBattler(N(t))}).filter(function(e){return void 0!==e})}},{key:"step",value:function(){if(!this.canUse())return!1;if(null===this.targets&&(this.targets=[].concat(Object(g.a)(this.fetchBattlers(this.user.side,this.targetPoints.self)),Object(g.a)(this.fetchBattlers(this.user.side.opponent,this.targetPoints.opponent)))),0===this.targets.length)return this.user.side.onActionEnd(),!1;var e=this.targets.shift();return this.attack=new L(this.user,e,this),!0}},{key:"getCurrentAttack",value:function(){return this.attack}}]),e}(),L=function e(t,a,n){Object(c.a)(this,e),this.user=void 0,this.target=void 0,this.action=void 0,this.hpDamageResult=void 0,this.spRecoveryResult=void 0,this.dpRecoveryResult=void 0,this.defenceIncreaseResult=void 0,this.attributeDamageResult=void 0,this.user=t,this.target=a,this.action=n;var i=this.user.side.damageMultiplier*this.action.data.hpDamage;this.hpDamageResult=this.target.applyHpDamage(i,this.action.data.attribute),this.spRecoveryResult=this.target.side.applySpRecovery(this.action.data.spRecovery),this.dpRecoveryResult=this.target.applyDpRecovery(this.action.data.dpRecovery),this.defenceIncreaseResult=this.target.applyDefenceIncrease(this.action.data.defenceIncrease),this.attributeDamageResult=this.target.applyAttributeDamage(this.action.data.attribute),this.action.data.weakStateRecover&&this.target.applyRecoverFromWeakState()},W=a(46),F=function(){function e(t,a){Object(c.a)(this,e),this._sideA=void 0,this._sideB=void 0,this._actions=void 0,this._phase=void 0,this._sidesSubject=void 0,this._inputtingPhase=void 0,this._actionResults=void 0,this.currentProcessingAction=void 0,this._inputtingAction=void 0,this._currentInputtingBattler=void 0,this._nextActionId=void 0,this._sideA=new T(t),this._sideB=new T(a),this._sideA.setOpponent(this._sideB),this._sideB.setOpponent(this._sideA),this._sidesSubject=new W.a([this._sideA,this._sideB]),this._actions=new W.a([]),this._phase=new W.a(void 0),this._inputtingPhase=new W.a(void 0),this._actionResults=new W.a([]),this._actions.next([]),this._actionResults.next([]),this.currentProcessingAction=void 0,this.startTurn(),this._nextActionId=0}return Object(u.a)(e,[{key:"addAction",value:function(e){return this.checkInputting("decideAction"),!(e.spCost>this._currentInputtingBattler.side.sp)&&(this._inputtingAction=e,this._inputtingPhase.next("decideTarget"),!0)}},{key:"setTargets",value:function(e){var t;this._inputtingAction.spCost<=this._currentInputtingBattler.side.sp&&(this._currentInputtingBattler.side.sp-=this._inputtingAction.spCost,t=this._currentInputtingBattler.side===this._sideA?{self:e.left,opponent:e.right}:{self:e.right,opponent:e.left},this._actions.value.push(new V(this._inputtingAction,this._currentInputtingBattler,t,this._nextActionId)),++this._nextActionId);this._inputtingPhase.next("decideBattler")}},{key:"selectBattler",value:function(e){this.checkInputting("decideBattler"),this._currentInputtingBattler=e,this._inputtingPhase.next("decideAction")}},{key:"checkInputting",value:function(e){if("inputting"!==this._phase.value)throw new Error("phase must be inputting");if(this._inputtingPhase.value!==e)throw new Error("inputting phase must be "+e)}},{key:"endInputting",value:function(){this._phase.next("processing"),this._inputtingPhase.next(void 0),this._actionResults.value.length=0,this._actionResults.next(this._actionResults.value),this.updateLoop()}},{key:"updateLoop",value:function(){var e=this;this.update(),"processing"===this._phase.value&&setTimeout(function(){return e.updateLoop()},200)}},{key:"update",value:function(){if("inputting"===this._phase.value)throw new Error("You shouldn't call update in inputting state.");for(;;){if(void 0!==this.currentProcessingAction&&this.currentProcessingAction.step())return this._actionResults.value.push(this.currentProcessingAction.getCurrentAttack()),void this._actionResults.next(this._actionResults.value);if(this.currentProcessingAction=this._actions.value.shift(),this._actions.next(this._actions.value),void 0===this.currentProcessingAction){this.startTurn();break}}this.dispatchSideChanges()}},{key:"cancelTargetSelection",value:function(){this.checkInputting("decideTarget"),this._inputtingAction=void 0,this._inputtingPhase.next("decideAction")}},{key:"cancelActionSelection",value:function(){this.checkInputting("decideAction"),this._currentInputtingBattler=void 0,this._inputtingPhase.next("decideBattler")}},{key:"startTurn",value:function(){this._sideA.onTurnStart(),this._sideB.onTurnStart(),this._phase.next("inputting"),this._inputtingPhase.next("decideBattler"),this.dispatchSideChanges()}},{key:"onActionDeleted",value:function(e){this.checkInputting("decideBattler");var t=this._actions.value.findIndex(function(t){return t.id===e}),a=this._actions.value.splice(t,1),n=Object(M.a)(a,1)[0];n.user.side.sp+=n.data.spCost,this._actions.next(this._actions.value)}},{key:"onPositionChange",value:function(e,t,a){var n,i=(n=a?this._sideA:this._sideB).getBattler(N(e)),s=n.getBattler(N(t));void 0!==i&&(i.position=t),void 0!==s&&(s.position=e),this.dispatchSideChanges()}},{key:"dispatchSideChanges",value:function(){this._sidesSubject.next([this._sideA,this._sideB])}},{key:"phase",get:function(){return this._phase}},{key:"sideA",get:function(){return this._sideA}},{key:"sideB",get:function(){return this._sideB}},{key:"actions",get:function(){return this._actions}},{key:"sides",get:function(){return this._sidesSubject}},{key:"inputtingPhase",get:function(){return this._inputtingPhase}},{key:"actionResults",get:function(){return this._actionResults}},{key:"inputtingAction",get:function(){return this._inputtingAction}},{key:"targets",get:function(){return void 0===this._currentInputtingBattler?void 0:this._currentInputtingBattler.side.opponent.battlers}}]),e}(),H=a(17),J=(P={},Object(b.a)(P,i.Earth,"\u5730"),Object(b.a)(P,i.Electric,"\u7535"),Object(b.a)(P,i.Fire,"\u706b"),Object(b.a)(P,i.Water,"\u6c34"),Object(b.a)(P,i.Wind,"\u98ce"),P),z=(R={},Object(b.a)(R,i.Earth,"fa-mountain"),Object(b.a)(R,i.Electric,"fa-bolt"),Object(b.a)(R,i.Fire,"fa-fire"),Object(b.a)(R,i.Water,"fa-tint"),Object(b.a)(R,i.Wind,"fa-wind"),R);function U(e){var t=e.isLeft?"btest/battler_left":"btest/battler_right",a={draggable:!0,onDragStart:function(a){void 0!==e.battler?a.dataTransfer.setData(t,e.pos.toString()):a.preventDefault()},onDrop:function(a){var n=parseInt(a.dataTransfer.getData(t));n!==e.pos&&(a.preventDefault(),e.onPositionChange(n,e.pos))},onDragOver:function(e){-1!==e.dataTransfer.types.indexOf(t)&&(e.dataTransfer.dropEffect="move",e.preventDefault())}};if(void 0===e.battler)return r.a.createElement("td",Object.assign({onMouseEnter:function(){return e.enter(e.pos)},onMouseLeave:function(){return e.exit(e.pos)}},a));var n=null,i=e.battler.attribute;null!==i&&(n=r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas "+z[i]})));var s=e.battler.dp===e.battler.maxDp?" maxed":"";return r.a.createElement("td",Object.assign({onMouseEnter:function(){return e.enter(e.pos)},onMouseLeave:function(){return e.exit(e.pos)},onClick:function(){return e.onClick(e.battler)}},a),r.a.createElement("p",{className:"battle-brief-view-name"},e.battler.name),r.a.createElement("p",{className:"battle-brief-view-dp"+s},e.battler.dp),r.a.createElement("p",{className:"battle-brief-view-icons"},e.battler.isDead()?r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-skull"})):null,e.battler.isWeakState()?r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-heart-broken"})):null,n))}function X(e){if(void 0===e.battler)return r.a.createElement("div",{className:"detail-view"});var t=e.battler.attribute;return console.log("BattlerDetailView",e.battler),r.a.createElement("div",{className:"detail-view"},r.a.createElement("p",null,e.battler.name,e.battler.isDead()?r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-skull"})):null,e.battler.isWeakState()?r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-heart-broken"})):null),r.a.createElement("p",null,r.a.createElement("b",null,"DP:")," ",e.battler.dp," / ",e.battler.maxDp),r.a.createElement("p",null,r.a.createElement("b",null,"\u6297:"),e.battler.defence),null===t?null:r.a.createElement("p",null,r.a.createElement("b",null,J[t])))}var Y=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={pos:void 0},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"onEnterBattler",value:function(e){this.setState({pos:e})}},{key:"onExitBattler",value:function(e){this.setState(function(t){return t.pos===e?{pos:void 0}:{pos:t.pos}})}},{key:"render",value:function(){var e=this,t=this.props.battlers.reduce(function(e,t){return e[t.position]=t,e},{}),a=this.props.isLeft?[0,1]:[1,0],n=void 0===this.state.pos?void 0:t[this.state.pos];return r.a.createElement(r.a.Fragment,null,r.a.createElement("table",{className:"battle-field-view"},r.a.createElement("tbody",null,[0,1,2].map(function(n){return r.a.createElement("tr",{key:n},0!==n||e.props.isLeft?null:r.a.createElement("td",{rowSpan:3,className:"frontline"},r.a.createElement("span",null,"\u524d\u7ebf")),a.map(function(a){return r.a.createElement(U,{pos:2*n+a,key:a,battler:t[2*n+a],enter:function(t){return e.onEnterBattler(t)},exit:function(t){return e.onExitBattler(t)},onClick:e.props.onBattlerClick,isLeft:e.props.isLeft,onPositionChange:e.props.onPositionChange})}),0===n&&e.props.isLeft?r.a.createElement("td",{rowSpan:3,className:"frontline"},r.a.createElement("span",null,"\u524d\u7ebf")):null)}))),r.a.createElement(X,{battler:n}))}}]),t}(r.a.Component);function $(e){return r.a.createElement("div",{className:"side-view column is-6"+(e.isRed?" red":" blue")},r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("b",null,"HP:")," ",e.side.hp),r.a.createElement("p",null,r.a.createElement("b",null,"AP:")," ",e.side.sp),r.a.createElement(Y,{isLeft:e.isRed,battlers:e.side.battlers,onBattlerClick:e.onBattlerClick,onPositionChange:e.onPositionChange})))}function q(e){return r.a.createElement("td",{className:e.highlighted?"highlighted":"",onClick:function(){return e.onClick()}},e.name)}var G=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={selectedPosition:{left:{0:!1,1:!1,2:!1,3:!1,4:!1,5:!1},right:{0:!1,1:!1,2:!1,3:!1,4:!1,5:!1}}},a.onTargetSelected=a.onTargetSelected.bind(Object(p.a)(a)),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"onTargetSelected",value:function(e,t){this.setState(function(a){var n={left:Object(v.a)({},a.selectedPosition.left),right:Object(v.a)({},a.selectedPosition.right)};return t?n.left[e]=!n.left[e]:n.right[e]=!n.right[e],{selectedPosition:n}})}},{key:"onConfirm",value:function(){var e=function(e){return Object.entries(e).filter(function(e){var t=Object(M.a)(e,2);t[0];return t[1]}).map(function(e){var t=Object(M.a)(e,2),a=t[0];t[1];return Number.parseInt(a)})},t=e(this.state.selectedPosition.left),a=e(this.state.selectedPosition.right);this.props.onTargetSelected({left:t,right:a})}},{key:"render",value:function(){var e=this,t=Array(6).fill(null),a=Array(6).fill(null);return this.props.battlersLeft.forEach(function(e){return t[e.position]=e}),this.props.battlersRight.forEach(function(e){return a[e.position]=e}),r.a.createElement("div",{className:"modal target-view is-active"},r.a.createElement("div",{className:"modal-background"}),r.a.createElement("div",{className:"modal-card"},r.a.createElement("header",{className:"modal-card-head"},r.a.createElement("p",{className:"modal-card-title"},"\u9009\u62e9\u76ee\u6807"),r.a.createElement("button",{className:"delete","aria-label":"close",onClick:function(){return e.props.onClose()}})),r.a.createElement("section",{className:"modal-card-body"},r.a.createElement("table",{className:"target-view-table"},r.a.createElement("tbody",null,[0,1,2].map(function(n){return r.a.createElement("tr",{key:n},[0,1].map(function(a){var i=j(n,a),s=t[i],o=null===s?"":s.name,l=e.state.selectedPosition.left[i];return r.a.createElement(q,{key:a,onClick:function(){return e.onTargetSelected(i,!0)},pos:i,name:o,highlighted:l})}),0===n?r.a.createElement("td",{rowSpan:3,className:"target-view-frontline"},"\u524d\u7ebf"):null,[1,0].map(function(t){var i=j(n,t),s=a[i],o=null===s?"":s.name,l=e.state.selectedPosition.right[i];return r.a.createElement(q,{key:t,onClick:function(){return e.onTargetSelected(i,!1)},pos:i,name:o,highlighted:l})}))})))),r.a.createElement("footer",{className:"modal-card-foot"},r.a.createElement("button",{className:"button is-success",onClick:function(){return e.onConfirm()}},"\u786e\u8ba4"),r.a.createElement("button",{className:"button",onClick:function(){return e.props.onClose()}},"\u53d6\u6d88"))))}}]),t}(r.a.Component);function K(e){var t=null;null!==e.result.attributeDamageResult&&(t=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,e.result.attributeDamageResult.knockedIntoWeak?"\u6253\u5165\u4e86\u5f31\u70b9\u72b6\u6001":"",e.result.attributeDamageResult.dpDamage>0?"\u9020\u6210\u4e86".concat(e.result.attributeDamageResult.dpDamage,"\u70b9DP\u4f24\u5bb3"):""," "),null===e.result.attributeDamageResult.damageMultipiler?null:r.a.createElement("p",null,"\u4f24\u5bb3\u63d0\u5347\u7387\u4e0a\u6da8\u4e86: ",e.result.attributeDamageResult.damageMultipiler.multiplierAdded)));var a=null;0!==e.result.dpRecoveryResult&&(a=r.a.createElement("p",null,"DP\u56de\u590d\u4e86\uff1a",e.result.dpRecoveryResult," "));var n=null;0!==e.result.spRecoveryResult&&(n=r.a.createElement("p",null,"SP\u56de\u590d\u4e86\uff1a",e.result.spRecoveryResult," "));var i=null;return 0!==e.result.defenceIncreaseResult&&(i=r.a.createElement("p",null,"\u9632\u5fa1\u4e0a\u6da8\u4e86\uff1a",e.result.defenceIncreaseResult)),r.a.createElement("div",{className:"result-view"},r.a.createElement("p",null,e.result.action.user.name," \u5bf9 ",e.result.target.name," \u4f7f\u7528\u4e86 ",e.result.action.data.name),r.a.createElement("p",null,"\u6d88\u8017\u4e86",e.result.hpDamageResult.defended,"\u70b9\u9632\u5fa1"),r.a.createElement("p",null,"\u9020\u6210\u4e86 ",e.result.hpDamageResult.hpDamage," \u70b9\u4f24\u5bb3 ",e.result.hpDamageResult.isDead?"\u5bf9\u9762\u5df2\u6b7b\u4ea1":""),t,a,n,i)}function Q(e){return r.a.createElement("p",{className:"action",onClick:function(){return e.onClicked(e.action)}},r.a.createElement("span",{className:"name"},e.action.name),"\xa0",r.a.createElement("span",{className:"sp-cost"},r.a.createElement("b",null,"SP\u6d88\u8017:"),e.action.spCost))}function Z(e){return r.a.createElement("div",{className:"actions-selection modal is-active"},r.a.createElement("div",{className:"modal-background"}),r.a.createElement("div",{className:"modal-card"},r.a.createElement("header",{className:"modal-card-head"},r.a.createElement("p",{className:"modal-card-title"},"\u9009\u62e9\u884c\u52a8"),r.a.createElement("button",{className:"delete","aria-label":"close",onClick:function(){return e.onActionSelectionClosed()}})),r.a.createElement("section",{className:"modal-card-body"},e.actionDatas.map(function(t,a){return r.a.createElement(Q,{action:t,key:a,onClicked:function(){return e.onActionClicked(t)}})}))))}function ee(e){return r.a.createElement("div",{className:"action-records"},e.actions.map(function(t){return r.a.createElement("p",{key:t.id,className:"action-record"},r.a.createElement("span",null,t.user.name),r.a.createElement("span",{className:"action-record-action-use"},"\u4f7f\u7528\u4e86"),r.a.createElement("span",{className:"action-record-action-name"},t.data.name),r.a.createElement("button",{className:"delete action-record-delete",onClick:function(a){a.preventDefault(),e.onActionDeleted(t.id)}},"X"))}))}var te=a(13),ae=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).subscription=void 0,a.battleVM=void 0,a.previousProps=void 0,a.state={phase:void 0,inputtingPhase:void 0,actionResults:[],actions:[],sideA:void 0,sideB:void 0},a.onActionClicked=a.onActionClicked.bind(Object(p.a)(a)),a.onTargetSelected=a.onTargetSelected.bind(Object(p.a)(a)),a.onBattlerSelected=a.onBattlerSelected.bind(Object(p.a)(a)),a.onTargetSelectionClosed=a.onTargetSelectionClosed.bind(Object(p.a)(a)),a.onActionSelectionClosed=a.onActionSelectionClosed.bind(Object(p.a)(a)),a.onActionDeleted=a.onActionDeleted.bind(Object(p.a)(a)),a.onPositionChange=a.onPositionChange.bind(Object(p.a)(a)),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"recreateBattleVM",value:function(){this.previousProps!==this.props&&(this.previousProps=this.props,void 0!==this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0),this.battleVM=void 0,void 0!==this.props.sideA&&void 0!==this.props.sideB&&(this.battleVM=new F(this.props.sideA,this.props.sideB),this.registerSubscriptions()))}},{key:"registerSubscriptions",value:function(){var e=this;if(void 0===this.subscription&&void 0!==this.battleVM){var t=[];t[0]=this.battleVM.phase.subscribe(function(t){return e.setState({phase:t})}),t[1]=this.battleVM.inputtingPhase.subscribe(function(t){return e.setState({inputtingPhase:t})}),t[2]=this.battleVM.actionResults.subscribe(function(t){return e.setState({actionResults:t})}),t[3]=this.battleVM.actions.subscribe(function(t){return e.setState({actions:t})}),t[4]=this.battleVM.sides.subscribe(function(t){var a=Object(M.a)(t,2),n=a[0],i=a[1];console.log("side changed",n),e.setState({sideA:n,sideB:i})}),this.subscription=new H.a,t.forEach(function(t){return e.subscription.add(t)})}}},{key:"componentDidMount",value:function(){this.registerSubscriptions()}},{key:"componentDidUpdate",value:function(){this.registerSubscriptions()}},{key:"onActionClicked",value:function(e){this.battleVM.addAction(e)}},{key:"onTargetSelected",value:function(e){this.battleVM.setTargets(e)}},{key:"onBattlerSelected",value:function(e){this.battleVM.selectBattler(e)}},{key:"onEndTurn",value:function(){this.battleVM.endInputting()}},{key:"onTargetSelectionClosed",value:function(){this.battleVM.cancelTargetSelection()}},{key:"onActionSelectionClosed",value:function(){this.battleVM.cancelActionSelection()}},{key:"onActionDeleted",value:function(e){this.battleVM.onActionDeleted(e)}},{key:"onPositionChange",value:function(e,t,a){this.battleVM.onPositionChange(e,t,a)}},{key:"render",value:function(){var e=this;if(this.recreateBattleVM(),void 0===this.battleVM)return r.a.createElement(te.a,{to:"/"});var t=null;console.log(this.state.inputtingPhase),void 0!==this.props.actionDatas&&"decideAction"===this.state.inputtingPhase&&(t=r.a.createElement(Z,{onActionClicked:this.onActionClicked,actionDatas:this.props.actionDatas,onActionSelectionClosed:this.onActionSelectionClosed}));var a=null;return"decideTarget"===this.state.inputtingPhase&&(a=r.a.createElement(G,{battlersLeft:this.state.sideA.battlers,battlersRight:this.state.sideB.battlers,onTargetSelected:this.onTargetSelected,onClose:this.onTargetSelectionClosed})),void 0===this.state.sideA||void 0===this.state.sideB?r.a.createElement(r.a.Fragment,null):r.a.createElement("div",{className:"container battle-view"},r.a.createElement("div",null,"\u6c34>\u706b>\u98ce>\u571f>\u7535>\u6c34"),r.a.createElement("div",{className:"columns"},r.a.createElement($,{isRed:!0,side:this.state.sideA,onBattlerClick:this.onBattlerSelected,onPositionChange:function(t,a){return e.onPositionChange(t,a,!0)}}),r.a.createElement($,{isRed:!1,side:this.state.sideB,onBattlerClick:this.onBattlerSelected,onPositionChange:function(t,a){return e.onPositionChange(t,a,!1)}})),r.a.createElement(ee,{actions:this.state.actions,onActionDeleted:this.onActionDeleted}),r.a.createElement("div",{className:"control"},"inputting"===this.state.phase?r.a.createElement("button",{className:"button",onClick:function(){return e.onEndTurn()}},"\u7ed3\u675f\u56de\u5408"):null),r.a.createElement("div",{className:"modal-container ".concat(null!==t||null!==a?"show":"")},null!==t?t:r.a.createElement(r.a.Fragment,null),null!==a?a:r.a.createElement(r.a.Fragment,null)),this.state.actionResults.map(function(e,t){return r.a.createElement(K,{key:t,result:e})}))}}]),t}(r.a.Component),ne=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={sideA:void 0,sideB:void 0,actions:[]},a.onComplete=a.onComplete.bind(Object(p.a)(a)),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"onComplete",value:function(e,t,a){this.setState({sideA:e,sideB:t,actions:a})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(te.b,{render:function(t){return r.a.createElement(x,Object.assign({onComplete:e.onComplete},t))},path:"/",exact:!0}),r.a.createElement(te.b,{render:function(t){return r.a.createElement(ae,Object.assign({},t,{sideA:e.state.sideA,sideB:e.state.sideB,actionDatas:e.state.actions}))},path:"/battle"}))}}]),t}(r.a.Component),ie=function(){return r.a.createElement(ne,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(43),a(44);l.a.render(r.a.createElement(I.a,null,r.a.createElement(ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[32,1,2]]]);
//# sourceMappingURL=main.02b01bdd.chunk.js.map